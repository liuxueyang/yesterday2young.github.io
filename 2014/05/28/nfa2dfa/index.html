<!doctype html>
<html class="theme-next use-motion">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>




  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>


<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.3.0rc5"/>






    <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.3.0rc5" />




  <title> NFA2DFA // wonders of the universe </title>
</head>

<body>
  <div class="container one-column page-post-detail">
    <div class="headband"></div>

    <div id="header" class="header">
      <div class="header-inner">
        <h1 class="site-meta">
    <a href="/" class="brand">
        <span class="logo">
          <i class="icon-logo"></i>
        </span>
        <span class="site-title">wonders of the universe</span>
    </a>
</h1>


  <ul id="menu" class="menu">
    
      
      <li class="menu-item menu-item-home">
        <a href="/">
          <i class="menu-item-icon icon-home"></i> <br />
          首页
        </a>
      </li>
    
      
      <li class="menu-item menu-item-archives">
        <a href="/archives">
          <i class="menu-item-icon icon-archives"></i> <br />
          归档
        </a>
      </li>
    
      
      <li class="menu-item menu-item-tags">
        <a href="/tags">
          <i class="menu-item-icon icon-tags"></i> <br />
          标签
        </a>
      </li>
    
  </ul>


      </div>
    </div>

    <div id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
            
          

          <div id="posts" class="posts-expand">
            
  

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              NFA2DFA
            
          
        </h1>
      

      <div class="post-meta">
          <span class="post-time">
            
              发表于 2014-05-28
            
          </span>
        
          
        
      </div>
    </div>

    
      <div class="post-body">

        
        

        
          <p>input:<br>number of symbols<br>symbol set(each space between two symbol)<br>number of states(state number starts from 1 to n by default)<br>start state number<br>number of accept states<br>accept states set<br>state transfer table (epsilon transfer is at column one and if there are several epsilon transfers, seperate them with a comma without spaces)<br>The following file is the input file. </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NFA2DFA.txt&#10;&#10;2&#10;a b&#10;4&#10;1&#10;1&#10;3&#10;3 2 1&#10;-1 1 -1&#10;-1 3 4&#10;-1 -1 3</span><br></pre></td></tr></table></figure>
<p>we input a integer N by str.txt file. then we generate accepted strings by DFA and NFA whose length is no more than N. Then compare those strings generated by NFA and DFA are all the same. The output is in str_out.txt</p>
<p>The following program is the main program.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*</span><br><span class="line"> * =====================================================================================</span><br><span class="line"> *       Filename : NFA2DFA.cpp</span><br><span class="line"> *    Description : </span><br><span class="line"> *    Version     : 0.1</span><br><span class="line"> *        Created : 05/13/14 20:43</span><br><span class="line"> *         Author : Liu Xue Yang (LXY), liuxueyang457@163.com</span><br><span class="line"> *         Motto  : How about today?</span><br><span class="line"> * =====================================================================================</span><br><span class="line"> */</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;cstdio&gt;</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;map&gt;</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;cstdlib&gt;</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;iostream&gt;</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;cstring&gt;</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;set&gt;</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;vector&gt;</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;iomanip&gt;</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;cctype&gt;</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;string&gt;</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stack&gt;</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> trans[<span class="number">1000</span>][<span class="number">1000</span>];</span><br><span class="line"><span class="keyword">int</span> n;                                          <span class="comment">/* number of symbols */</span></span><br><span class="line"><span class="keyword">char</span> ch[<span class="number">1000</span>];                                  <span class="comment">/* symbol set */</span></span><br><span class="line"><span class="keyword">int</span> start_state;                                <span class="comment">/* start state */</span></span><br><span class="line"><span class="keyword">int</span> n_state;                                    <span class="comment">/* number of states */</span></span><br><span class="line"><span class="keyword">int</span> nac_state;                                  <span class="comment">/* number of accept states */</span></span><br><span class="line"><span class="keyword">int</span> ac[<span class="number">1000</span>];                                   <span class="comment">/* accept states */</span></span><br><span class="line"><span class="keyword">char</span> input[<span class="number">1000</span>];                               <span class="comment">/* input string */</span></span><br><span class="line"><span class="keyword">int</span> start = <span class="number">1</span>;                                  <span class="comment">/* start state */</span></span><br><span class="line"><span class="keyword">bool</span> flag = <span class="keyword">true</span>;                               <span class="comment">/* whether the string is legal */</span></span><br><span class="line"><span class="keyword">bool</span> mark_ac;                                   <span class="comment">/* whether the string is accepted */</span></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span> dfa_ac;</span><br><span class="line"><span class="stl_container"><span class="built_in">vector</span>&lt;<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span> &gt;</span> e_s;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs_nfa</span><span class="params">(<span class="built_in">string</span>, <span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs_dfa</span><span class="params">(<span class="built_in">string</span>, <span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">ac_check</span><span class="params">(<span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">ac_check_dfa</span><span class="params">(<span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">all_check</span><span class="params">(<span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="stl_container"><span class="built_in">vector</span>&lt;<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span> &gt;</span> Newtrans;</span><br><span class="line"><span class="stl_container"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;</span> dfa_generate, nfa_generate;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span><br><span class="line"> * ===  FUNCTION  ======================================================================</span><br><span class="line"> *         Name: main</span><br><span class="line"> * =====================================================================================</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span></span><br><span class="line"><span class="title">main</span> <span class="params">( <span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[] )</span></span><br><span class="line"></span>&#123;</span><br><span class="line"></span><br><span class="line">	freopen(<span class="string">"NFA2DFA.txt"</span>, <span class="string">"r"</span>, stdin);</span><br><span class="line"></span><br><span class="line">	dfa_ac.clear();</span><br><span class="line">	<span class="built_in">scanf</span> ( <span class="string">"%d"</span>, &amp;n);</span><br><span class="line">	getchar();</span><br><span class="line">	<span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i ) &#123;</span><br><span class="line">		<span class="built_in">scanf</span> ( <span class="string">"%c"</span>, &amp;ch[i] );</span><br><span class="line">		getchar();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">scanf</span> ( <span class="string">"%d%d%d"</span>, &amp;n_state, &amp;start_state, &amp;nac_state );</span><br><span class="line">	<span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nac_state; ++i ) &#123;</span><br><span class="line">		<span class="built_in">scanf</span> ( <span class="string">"%d"</span>, &amp;ac[i] );</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">string</span> str;</span><br><span class="line">	e_s.clear();</span><br><span class="line">	<span class="keyword">char</span> buffer[<span class="number">1111</span>];</span><br><span class="line">	<span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n_state; ++i ) &#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; str;</span><br><span class="line">		<span class="built_in">memset</span>(buffer, <span class="number">0</span>, <span class="keyword">sizeof</span>(buffer));</span><br><span class="line">		<span class="built_in">strcpy</span>(buffer, str.c_str());</span><br><span class="line">		<span class="keyword">char</span> *pch = strtok(buffer, <span class="string">","</span>);</span><br><span class="line">		<span class="keyword">char</span> suffer[<span class="number">1000</span>];</span><br><span class="line">		<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span> t_a;</span><br><span class="line">		t_a.clear();</span><br><span class="line">		<span class="keyword">while</span> ( NULL != pch ) &#123;</span><br><span class="line">			<span class="built_in">memset</span>(suffer, <span class="number">0</span>, <span class="keyword">sizeof</span>(suffer));</span><br><span class="line">			<span class="built_in">strcpy</span>(suffer, pch);</span><br><span class="line">			<span class="keyword">int</span> su_n = atoi(suffer);</span><br><span class="line">			t_a.push_back(su_n);</span><br><span class="line">			pch = strtok(NULL, <span class="string">","</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		e_s.push_back(t_a);</span><br><span class="line">		<span class="keyword">for</span> ( <span class="keyword">int</span> j = <span class="number">1</span>; j &lt; n + <span class="number">1</span>; ++j ) &#123;</span><br><span class="line">			<span class="built_in">scanf</span> ( <span class="string">"%d"</span>, &amp;trans[i][j] );</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span>::iterator i_t;</span><br><span class="line">	<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span> v;</span><br><span class="line"></span><br><span class="line">	<span class="stl_container"><span class="built_in">map</span>&lt;<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span>, <span class="keyword">int</span> &gt;</span> mystate;</span><br><span class="line">	mystate.clear();</span><br><span class="line"></span><br><span class="line">	Newtrans.clear();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> ii;</span><br><span class="line">	ii = <span class="number">0</span>;</span><br><span class="line">	<span class="stl_container"><span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;</span> s_in;</span><br><span class="line">	s_in.clear();</span><br><span class="line">	v.push_back(start_state);</span><br><span class="line">	s_in.insert(start_state);</span><br><span class="line">	<span class="comment">// start_state enclosure</span></span><br><span class="line">	<span class="keyword">for</span> ( i_t = e_s[start_state-<span class="number">1</span>].begin(); i_t != e_s[start_state-<span class="number">1</span>].end(); ++i_t ) &#123;</span><br><span class="line">		<span class="keyword">if</span> ( -<span class="number">1</span> != *i_t &amp;&amp; s_in.count(*i_t) == <span class="number">0</span>) &#123;</span><br><span class="line">			v.push_back(*i_t);</span><br><span class="line">			s_in.insert(*i_t);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span>::iterator it;</span><br><span class="line">	<span class="keyword">bool</span> in_ac = <span class="keyword">false</span>;</span><br><span class="line">	<span class="keyword">for</span> ( it = v.begin(); it != v.end(); ++it ) &#123;</span><br><span class="line">		<span class="keyword">for</span> ( <span class="keyword">int</span> jk = <span class="number">0</span>; jk &lt; nac_state; ++jk ) &#123;</span><br><span class="line">			<span class="keyword">if</span> ( ac[jk] == (*it) ) &#123;</span><br><span class="line">				in_ac = <span class="keyword">true</span>;</span><br><span class="line">				dfa_ac.push_back(<span class="number">0</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> ( in_ac ) &#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	sort(v.begin(), v.end());</span><br><span class="line"></span><br><span class="line">	<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span> add;</span><br><span class="line">	add.clear();</span><br><span class="line"></span><br><span class="line">	mystate.insert(pair&lt;<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span>, <span class="keyword">int</span>&gt;(v, ii));</span><br><span class="line">	++ii;</span><br><span class="line">	Newtrans.push_back(add);                      <span class="comment">/* push_back a empty vector */</span></span><br><span class="line"></span><br><span class="line">	<span class="stl_container"><span class="built_in">stack</span>&lt;<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span> &gt;</span> stac;</span><br><span class="line">	stac.push(v);</span><br><span class="line">	<span class="keyword">while</span> ( !stac.empty() ) &#123;                     <span class="comment">/*if stack if not empty we will search new state */</span></span><br><span class="line">		<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span> tmp;</span><br><span class="line">		v = stac.top();</span><br><span class="line">		stac.pop();</span><br><span class="line">		<span class="keyword">int</span> jj;</span><br><span class="line">		jj = mystate[v];</span><br><span class="line">		<span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n + <span class="number">1</span>; ++i ) &#123;         <span class="comment">/* for every symbol */</span></span><br><span class="line">			tmp.clear();</span><br><span class="line">			s_in.clear();</span><br><span class="line">			<span class="comment">// move(v, i) = tmp</span></span><br><span class="line">			<span class="keyword">for</span> ( it = v.begin(); it != v.end(); ++it ) &#123; <span class="comment">/* for every symbol in this set (this symbol as input) */</span></span><br><span class="line">				<span class="keyword">if</span> (-<span class="number">1</span> != trans[(*it)-<span class="number">1</span>][i] &amp;&amp; s_in.count(trans[(*it)-<span class="number">1</span>][i]) == <span class="number">0</span>) &#123; <span class="comment">/* we can not push_back -1!!!f**k!!! */</span></span><br><span class="line">					tmp.push_back(trans[(*it)-<span class="number">1</span>][i]);     <span class="comment">/* =_= T_T I wasted so much time to debug here!!!!!! T^T */</span></span><br><span class="line">					s_in.insert(trans[(*it)-<span class="number">1</span>][i]);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// get enclosure tmp-enclosure</span></span><br><span class="line">			<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span> tmp_i;</span><br><span class="line">			tmp_i = tmp;</span><br><span class="line">			<span class="keyword">for</span> ( it = tmp.begin(); it != tmp.end(); ++it ) &#123; <span class="comment">/* get stuck!!! command terminated */</span></span><br><span class="line">				<span class="keyword">for</span> ( i_t = e_s[(*it)-<span class="number">1</span>].begin(); i_t != e_s[(*it)-<span class="number">1</span>].end(); ++i_t ) &#123;</span><br><span class="line">					<span class="keyword">if</span> ( -<span class="number">1</span> != *i_t &amp;&amp; s_in.count(*i_t) == <span class="number">0</span> ) &#123;</span><br><span class="line">						tmp_i.push_back(*i_t);              <span class="comment">/* we cannot modify tmp */</span></span><br><span class="line">						s_in.insert(*i_t);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			tmp = tmp_i;</span><br><span class="line">			sort(tmp.begin(), tmp.end());</span><br><span class="line">			<span class="keyword">if</span> ( (tmp.size() != <span class="number">0</span>) &amp;&amp; !mystate.count(tmp)) &#123;                  <span class="comment">/* do not have it */</span></span><br><span class="line">				mystate.insert(pair&lt;<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span>, <span class="keyword">int</span>&gt;(tmp, ii));</span><br><span class="line">				in_ac = <span class="keyword">false</span>;</span><br><span class="line">				<span class="keyword">for</span> ( it = tmp.begin(); it != tmp.end(); ++it ) &#123;</span><br><span class="line">					<span class="keyword">for</span> ( <span class="keyword">int</span> jk = <span class="number">0</span>; jk &lt; nac_state; ++jk ) &#123;</span><br><span class="line">						<span class="keyword">if</span> ( ac[jk] == (*it) ) &#123;</span><br><span class="line">							in_ac = <span class="keyword">true</span>;</span><br><span class="line">							dfa_ac.push_back(ii);</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">if</span> ( in_ac ) &#123;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				add.clear();</span><br><span class="line">				Newtrans.push_back(add);</span><br><span class="line">				ii++;</span><br><span class="line">				stac.push(tmp);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (tmp.size() != <span class="number">0</span>) &#123;</span><br><span class="line">				Newtrans[jj].push_back(mystate[tmp]);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				Newtrans[jj].push_back(-<span class="number">1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="comment">//	vector&lt;vector&lt;int&gt; &gt;::iterator j_t;</span></span><br><span class="line"><span class="comment">//	for ( j_t = Newtrans.begin(); j_t != Newtrans.end(); ++j_t ) &#123;</span></span><br><span class="line"><span class="comment">//		for ( it = (*j_t).begin(); it != (*j_t).end(); ++it ) &#123;</span></span><br><span class="line"><span class="comment">//			cout &lt;&lt; *it &lt;&lt; " ";</span></span><br><span class="line"><span class="comment">//		&#125;</span></span><br><span class="line"><span class="comment">//		cout &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//	&#125;</span></span><br><span class="line">	<span class="comment">// succeed!</span></span><br><span class="line">	<span class="comment">// Out put DFA!</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ii; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> ( it = Newtrans[i].begin(); it != Newtrans[i].end(); ++it ) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; *it &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// output accepted state</span></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"accepted state: "</span>; </span><br><span class="line">	<span class="keyword">for</span> ( it = dfa_ac.begin(); it != dfa_ac.end() ; ++it ) &#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; *it &lt;&lt; <span class="string">" "</span>; </span><br><span class="line">	&#125;</span><br><span class="line">	N = <span class="number">3</span>;</span><br><span class="line">	dfa_generate.clear();</span><br><span class="line">	nfa_generate.clear();</span><br><span class="line"><span class="comment">//	printf ( "\n" );</span></span><br><span class="line">	freopen(<span class="string">"str.txt"</span>, <span class="string">"r"</span>, stdin);</span><br><span class="line">	freopen(<span class="string">"str_out.txt"</span>, <span class="string">"w"</span>, stdout);</span><br><span class="line">	<span class="keyword">while</span> ( ~<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N) ) &#123;</span><br><span class="line">		<span class="built_in">string</span> sad = <span class="string">""</span>;</span><br><span class="line">		dfs_dfa(sad, <span class="number">0</span>);</span><br><span class="line">		sort(dfa_generate.begin(), dfa_generate.end());</span><br><span class="line">		<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;</span>::iterator end_u, sadbu;</span><br><span class="line">		end_u = unique(dfa_generate.begin(), dfa_generate.end());</span><br><span class="line">		dfa_generate.erase(end_u, dfa_generate.end());</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"********************"</span> &lt;&lt; endl; </span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"size = "</span> &lt;&lt; dfa_generate.size() &lt;&lt; endl; </span><br><span class="line">		<span class="keyword">for</span> ( sadbu = dfa_generate.begin(); sadbu != dfa_generate.end(); ++sadbu ) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; *sadbu &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">		sad = <span class="string">""</span>;</span><br><span class="line">		dfs_nfa(sad, <span class="number">1</span>);</span><br><span class="line">		sort(nfa_generate.begin(), nfa_generate.end());</span><br><span class="line">		end_u = unique(nfa_generate.begin(), nfa_generate.end());</span><br><span class="line">		nfa_generate.erase(end_u, nfa_generate.end());</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"********************"</span> &lt;&lt; endl; </span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"size = "</span> &lt;&lt; nfa_generate.size() &lt;&lt; endl; </span><br><span class="line">		<span class="keyword">for</span> ( sadbu = nfa_generate.begin(); sadbu != nfa_generate.end(); ++sadbu ) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; *sadbu &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">bool</span> mark = <span class="keyword">true</span>;</span><br><span class="line">		<span class="keyword">if</span> ( dfa_generate.size() != nfa_generate.size() ) &#123;</span><br><span class="line">			mark = <span class="keyword">false</span>;</span><br><span class="line">			<span class="built_in">printf</span> ( <span class="string">"size is Different!\n"</span> );</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">for</span> ( <span class="keyword">int</span> js = <span class="number">0</span>; js &lt; dfa_generate.size(); ++js ) &#123;</span><br><span class="line">				<span class="keyword">if</span> ( dfa_generate[js] != nfa_generate[js] ) &#123;</span><br><span class="line">					mark = <span class="keyword">false</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> ( mark ) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">"Same!"</span> &lt;&lt; endl; </span><br><span class="line">		&#125; </span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">"Different!"</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;				<span class="comment">/* ----------  end of function main  ---------- */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span><br><span class="line"> * ===  FUNCTION  ======================================================================</span><br><span class="line"> *         Name:  dfs_dfa</span><br><span class="line"> *  Description:  dfs to generate string</span><br><span class="line"> * =====================================================================================</span><br><span class="line"> */</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span></span><br><span class="line"><span class="title">dfs_dfa</span> <span class="params">( <span class="built_in">string</span> str, <span class="keyword">int</span> now )</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> len = str.length();</span><br><span class="line">	<span class="keyword">if</span> ( len &gt; N ) &#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ( len &gt; <span class="number">0</span> &amp;&amp; len &lt;= N &amp;&amp; ac_check_dfa(now) ) &#123;</span><br><span class="line">		dfa_generate.push_back(str);</span><br><span class="line"><span class="comment">//		cout &lt;&lt; str &lt;&lt; endl;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span>::iterator jk;</span><br><span class="line">	<span class="keyword">for</span> ( jk = Newtrans[now].begin(); jk != Newtrans[now].end(); ++jk ) &#123;</span><br><span class="line">		<span class="keyword">if</span> ( -<span class="number">1</span> != *jk ) &#123;</span><br><span class="line">			dfs_dfa(str + ch[jk-Newtrans[now].begin()], *jk);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">&#125;		<span class="comment">/* -----  end of function dfs_dfa  ----- */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span><br><span class="line"> * ===  FUNCTION  ======================================================================</span><br><span class="line"> *         Name:  dfs_nfa</span><br><span class="line"> *  Description:  dfs to generate string</span><br><span class="line"> * =====================================================================================</span><br><span class="line"> */</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span></span><br><span class="line"><span class="title">dfs_nfa</span> <span class="params">( <span class="built_in">string</span> str, <span class="keyword">int</span> now )</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> len = str.length();</span><br><span class="line">	<span class="keyword">if</span> ( len &gt; N ) &#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ( len &gt; <span class="number">0</span> &amp;&amp; len &lt;= N &amp;&amp; all_check(now) ) &#123;</span><br><span class="line">		nfa_generate.push_back(str);</span><br><span class="line"><span class="comment">//		cout &lt;&lt; str &lt;&lt; endl;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n + <span class="number">1</span>; ++i ) &#123;</span><br><span class="line">		<span class="keyword">if</span> ( -<span class="number">1</span> != trans[now-<span class="number">1</span>][i] ) &#123;</span><br><span class="line">			dfs_nfa(str+ch[i-<span class="number">1</span>], trans[now-<span class="number">1</span>][i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span>::iterator i_t;</span><br><span class="line">	<span class="keyword">for</span> ( i_t = e_s[now-<span class="number">1</span>].begin(); i_t != e_s[now-<span class="number">1</span>].end(); ++i_t ) &#123;</span><br><span class="line">		<span class="keyword">if</span> ( -<span class="number">1</span> != *i_t ) &#123;</span><br><span class="line">			dfs_nfa(str, *i_t);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">&#125;		<span class="comment">/* -----  end of function dfs_nfa  ----- */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span><br><span class="line"> * ===  FUNCTION  ======================================================================</span><br><span class="line"> *         Name:  all_check</span><br><span class="line"> *  Description:  enclosure check</span><br><span class="line"> * =====================================================================================</span><br><span class="line"> */</span></span><br><span class="line">	<span class="function"><span class="keyword">bool</span></span><br><span class="line"><span class="title">all_check</span> <span class="params">( <span class="keyword">int</span> sta )</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> mark = <span class="keyword">false</span>;</span><br><span class="line">	mark = ac_check(sta);</span><br><span class="line">	<span class="keyword">if</span> ( mark ) &#123;</span><br><span class="line">		<span class="keyword">return</span> mark;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="comment">//	vector&lt;int&gt;::iterator i_t;</span></span><br><span class="line"><span class="comment">//	for ( i_t = e_s[sta-1].begin(); i_t != e_s[sta-1].end(); ++i_t ) &#123;</span></span><br><span class="line"><span class="comment">//		if ( -1 != *i_t ) &#123;</span></span><br><span class="line"><span class="comment">//			mark = ac_check(*i_t);</span></span><br><span class="line"><span class="comment">//			if ( mark ) &#123;</span></span><br><span class="line"><span class="comment">//				break;</span></span><br><span class="line"><span class="comment">//			&#125;</span></span><br><span class="line"><span class="comment">//		&#125;</span></span><br><span class="line"><span class="comment">//		else break;</span></span><br><span class="line"><span class="comment">//	&#125;</span></span><br><span class="line">	<span class="keyword">return</span> mark;</span><br><span class="line">&#125;		<span class="comment">/* -----  end of function all_check  ----- */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span><br><span class="line"> * ===  FUNCTION  ======================================================================</span><br><span class="line"> *         Name:  ac_check</span><br><span class="line"> *  Description:  check whether a state is accepted</span><br><span class="line"> * =====================================================================================</span><br><span class="line"> */</span></span><br><span class="line">	<span class="function"><span class="keyword">bool</span></span><br><span class="line"><span class="title">ac_check</span> <span class="params">( <span class="keyword">int</span> sta )</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> mark = <span class="keyword">false</span>;</span><br><span class="line">	<span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nac_state; ++i ) &#123;</span><br><span class="line">		<span class="keyword">if</span> ( sta == ac[i] ) &#123;</span><br><span class="line">			mark = <span class="keyword">true</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> mark;</span><br><span class="line">&#125;		<span class="comment">/* -----  end of function ac_check  ----- */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span><br><span class="line"> * ===  FUNCTION  ======================================================================</span><br><span class="line"> *         Name:  ac_check_dfa</span><br><span class="line"> *  Description:  check whether it is legal</span><br><span class="line"> * =====================================================================================</span><br><span class="line"> */</span></span><br><span class="line">	<span class="function"><span class="keyword">bool</span></span><br><span class="line"><span class="title">ac_check_dfa</span> <span class="params">( <span class="keyword">int</span> sta )</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> mark = <span class="keyword">false</span>;</span><br><span class="line">	<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span>::iterator it;</span><br><span class="line">	<span class="keyword">for</span> ( it = dfa_ac.begin(); it != dfa_ac.end(); ++it ) &#123;</span><br><span class="line">		<span class="keyword">if</span> ( (*it) == sta ) &#123;</span><br><span class="line">			mark = <span class="keyword">true</span>;</span><br><span class="line">			<span class="keyword">return</span> mark;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> mark;</span><br><span class="line">&#125;		<span class="comment">/* -----  end of function ac_check_dfa  ----- */</span></span><br></pre></td></tr></table></figure>
<p>Nice.</p>
<hr>
<p>Maybe I made a mistake! I forget a case:<br>when I get epsilon of a node, it may have some consistent epsilon transfers! So I should use dfs to get the whole epsilon!</p>
<p>I find this problem when I read this blog: <a href="www.cnblgos.com/cyjb/archive/LexerDfa.html">cyjb</a><br>Thank You!<br>I will fix the problem later.</p>

        

      </div>
    

    
      <div class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/c/">
                #c++
              </a>
            
          </div>
        

        
          <div class="post-nav">
            <div class="post-nav-prev post-nav-item">
              
                <a href="/2014/05/30/editor/">Editor</a>
              
            </div>

            <div class="post-nav-next post-nav-item">
              
                <a href="/2014/05/27/chapter-5/">Chapter 5</a>
              
            </div>
          </div>
        

        
        
      </div>
    
  </div>



  
    <div class="comments" id="comments">
      
    </div>
  

          </div>

          
        </div>

        
<div class="sidebar-toggle">
  <div class="sidebar-toggle-line-wrap">
    <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
    <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
    <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
  </div>
</div>

<div id="sidebar" class="sidebar">
  <div class="sidebar-inner">

    
      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview" data-target="site-overview">
          站点概览
        </li>
      </ul>
    

    <div class="site-overview">
      <div class="site-author motion-element">
        <img class="site-author-image" src="/images/default_avatar.jpg" alt="liuxueyang" />
        <p class="site-author-name">liuxueyang</p>
      </div>
      <p class="site-description motion-element"></p>
      <div class="site-state motion-element">
        <div class="site-state-item site-state-posts">
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">日志</span>
        </div>
        <div class="site-state-item site-state-tags">
            <span class="site-state-item-count">11</span>
            <span class="site-state-item-name">标签</span>
        </div>
        <div class="site-state-item site-state-pages">
            <span class="site-state-item-count">0</span>
            <span class="site-state-item-name">页面</span>
        </div>
      </div>

      

      <div class="social-info motion-element">
        
      </div>

    </div>

    
      <div class="post-toc sidebar-panel-active">
        
      </div>
    
  </div>
</div>


      </div>
    </div>

    <div id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; &nbsp; 
  2015
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author">liuxueyang</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT</a>
</div>





      </div>
    </div>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $(".fancybox").fancybox();
    });
  </script>

  <script type="text/javascript">
  function hasMobileUA () {
    var nav = window.navigator;
    var ua = nav.userAgent;
    var pa = /iPad|iPhone|Android|Opera Mini|BlackBerry|webOS|UCWEB|Blazer|PSP|IEMobile|Symbian/g;

    return pa.test(ua);
  }

  function isDesktop () {
    return screen.width > 991 && !hasMobileUA();
  }

  function isTablet () {
    return screen.width < 992 && screen.width > 767 && hasMobileUA();
  }

  function isMobile () {
    return screen.width < 767 && hasMobileUA();
  }

  function escapeSelector (selector) {
    return selector.replace(/[!"$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g, "\\$&")
  }
</script>

  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  

  <script type="text/javascript" id="motion.global">
  $(document).ready(function () {
    var body = $('body');
    var isSidebarVisible = false;
    var sidebarToggle = $('.sidebar-toggle');
    var sidebarToggleLine1st = $('.sidebar-toggle-line-first')
    var sidebarToggleLine2nd = $('.sidebar-toggle-line-middle');
    var sidebarToggleLine3rd = $('.sidebar-toggle-line-last');
    var sidebar = $('.sidebar');

    var SIDEBAR_WIDTH = '320px';
    var SIDEBAR_DISPLAY_DURATION = 300;

    var sidebarToogleLineStatusInit = {width: '100%', opacity: 1, left: 0, rotateZ: 0, top: 0};

    var sidebarToggleLine1stStatusInit = sidebarToogleLineStatusInit;
    var sidebarToggleLine1stStatusArrow = {width: '50%', rotateZ: '-45deg', top: '2px'};
    var sidebarToogleLine1stStatusClose = {width: '100%', rotateZ: '-45deg', top: '5px'};

    var sidebarToggleLine2ndStatusInit = sidebarToogleLineStatusInit;
    var sidebarToggleLine2ndStatusArrow = {width: '90%'};
    var sidebarToogleLine2ndStatusClose = {opacity: 0};

    var sidebarToggleLine3rdStatusInit = sidebarToogleLineStatusInit;
    var sidebarToggleLine3rdStatusArrow = {width: '50%', rotateZ: '45deg', top: '-2px'};
    var sidebarToogleLine3rdStatusClose = {width: '100%', rotateZ: '45deg', top: '-5px'};

    sidebatToggleMotion();
    postsListMotion();
    backToTopMotion();


    $(document)
      .on('sidebar.isShowing', function () {
        isDesktop() && body.velocity(
          {paddingRight: SIDEBAR_WIDTH},
          SIDEBAR_DISPLAY_DURATION
        );
        sidebarContentMotion();
      })
      .on('sidebar.isHiding', function () {});


    function backToTopMotion () {
      var b2top = $('.back-to-top');
      b2top.on('click', function () {
        body.velocity('scroll');
      });
    }

    function sidebarShowMotion () {

      sidebarToggleLine1st.velocity(sidebarToogleLine1stStatusClose);
      sidebarToggleLine2nd.velocity(sidebarToogleLine2ndStatusClose);
      sidebarToggleLine3rd.velocity(sidebarToogleLine3rdStatusClose);

      sidebar.velocity({width: SIDEBAR_WIDTH}, {
        duration: SIDEBAR_DISPLAY_DURATION,
        complete: function () {
          sidebar.addClass('sidebar-active');
          sidebar.trigger('sidebar.didShow');
        }
      });
      sidebar.trigger('sidebar.isShowing');
    }

    function sidebarHideMotion () {
      isDesktop() && body.velocity({paddingRight: 0});
      sidebar.velocity('reverse');

      sidebarToggleLine1st.velocity(sidebarToggleLine1stStatusInit);
      sidebarToggleLine2nd.velocity(sidebarToggleLine2ndStatusInit);
      sidebarToggleLine3rd.velocity(sidebarToggleLine3rdStatusInit);

      sidebar.removeClass('sidebar-active');
      sidebar.trigger('sidebar.isHiding');
    };

    function sidebarContentMotion () {
      $('.sidebar .motion-element').velocity(
        'transition.slideRightIn',
        {stagger: 50, drag: true}
      );
    }

    function postsListMotion () {
      $('.post').velocity('transition.slideDownIn', {stagger: 300, drag: true});
    }

    function sidebatToggleMotion () {
      sidebarToggle.on('click', function () {
        isSidebarVisible ? sidebarHideMotion() : sidebarShowMotion();
        isSidebarVisible = !isSidebarVisible;
      });

      sidebarToggle.hover(function () {
        if (isSidebarVisible) {return}
        sidebarToggleLine1st.velocity('stop').velocity(sidebarToggleLine1stStatusArrow);
        sidebarToggleLine2nd.velocity('stop').velocity(sidebarToggleLine2ndStatusArrow);
        sidebarToggleLine3rd.velocity('stop').velocity(sidebarToggleLine3rdStatusArrow);
      }, function () {
        if (isSidebarVisible) {return}
        sidebarToggleLine1st.velocity('stop').velocity(sidebarToggleLine1stStatusInit);
        sidebarToggleLine2nd.velocity('stop').velocity(sidebarToggleLine2ndStatusInit);
        sidebarToggleLine3rd.velocity('stop').velocity(sidebarToggleLine3rdStatusInit);
      });
    }
  });

</script>





  
  
<script type="text/javascript" id="bootstrap.scrollspy.custom">
  /* ========================================================================
  * Bootstrap: scrollspy.js v3.3.2
  * http://getbootstrap.com/javascript/#scrollspy
  * ========================================================================
  * Copyright 2011-2015 Twitter, Inc.
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
  * ======================================================================== */

  /**
   * Custom by iissnan
   *
   * - Add a `clear.bs.scrollspy` event.
   * - Esacpe targets selector.
   */


  +function ($) {
    'use strict';

    // SCROLLSPY CLASS DEFINITION
    // ==========================

    function ScrollSpy(element, options) {
      this.$body          = $(document.body)
      this.$scrollElement = $(element).is(document.body) ? $(window) : $(element)
      this.options        = $.extend({}, ScrollSpy.DEFAULTS, options)
      this.selector       = (this.options.target || '') + ' .nav li > a'
      this.offsets        = []
      this.targets        = []
      this.activeTarget   = null
      this.scrollHeight   = 0

      this.$scrollElement.on('scroll.bs.scrollspy', $.proxy(this.process, this))
      this.refresh()
      this.process()
    }

    ScrollSpy.VERSION  = '3.3.2'

    ScrollSpy.DEFAULTS = {
      offset: 10
    }

    ScrollSpy.prototype.getScrollHeight = function () {
      return this.$scrollElement[0].scrollHeight || Math.max(this.$body[0].scrollHeight, document.documentElement.scrollHeight)
    }

    ScrollSpy.prototype.refresh = function () {
      var that          = this
      var offsetMethod  = 'offset'
      var offsetBase    = 0

      this.offsets      = []
      this.targets      = []
      this.scrollHeight = this.getScrollHeight()

      if (!$.isWindow(this.$scrollElement[0])) {
        offsetMethod = 'position'
        offsetBase   = this.$scrollElement.scrollTop()
      }

      this.$body
        .find(this.selector)
        .map(function () {
          var $el   = $(this)
          var href  = $el.data('target') || $el.attr('href')
          var $href = /^#./.test(href) && $(escapeSelector(href)) // Need to escape selector.

          return ($href
            && $href.length
            && $href.is(':visible')
            && [[$href[offsetMethod]().top + offsetBase, href]]) || null
        })
        .sort(function (a, b) { return a[0] - b[0] })
        .each(function () {
          that.offsets.push(this[0])
          that.targets.push(this[1])
        })


    }

    ScrollSpy.prototype.process = function () {
      var scrollTop    = this.$scrollElement.scrollTop() + this.options.offset
      var scrollHeight = this.getScrollHeight()
      var maxScroll    = this.options.offset + scrollHeight - this.$scrollElement.height()
      var offsets      = this.offsets
      var targets      = this.targets
      var activeTarget = this.activeTarget
      var i

      if (this.scrollHeight != scrollHeight) {
        this.refresh()
      }

      if (scrollTop >= maxScroll) {
        return activeTarget != (i = targets[targets.length - 1]) && this.activate(i)
      }

      if (activeTarget && scrollTop < offsets[0]) {
        $(this.selector).trigger('clear.bs.scrollspy')  // Add a custom event.
        this.activeTarget = null
        return this.clear()
      }

      for (i = offsets.length; i--;) {
        activeTarget != targets[i]
          && scrollTop >= offsets[i]
          && (!offsets[i + 1] || scrollTop <= offsets[i + 1])
          && this.activate(targets[i])
      }
    }

    ScrollSpy.prototype.activate = function (target) {
      this.activeTarget = target

      this.clear()

      var selector = this.selector +
        '[data-target="' + target + '"],' +
        this.selector + '[href="' + target + '"]'

      var active = $(selector)
        .parents('li')
        .addClass('active')

      if (active.parent('.dropdown-menu').length) {
        active = active
          .closest('li.dropdown')
          .addClass('active')
      }

      active.trigger('activate.bs.scrollspy')
    }

    ScrollSpy.prototype.clear = function () {
      $(this.selector)
        .parentsUntil(this.options.target, '.active')
        .removeClass('active')
    }


    // SCROLLSPY PLUGIN DEFINITION
    // ===========================

    function Plugin(option) {
      return this.each(function () {
        var $this   = $(this)
        var data    = $this.data('bs.scrollspy')
        var options = typeof option == 'object' && option

        if (!data) $this.data('bs.scrollspy', (data = new ScrollSpy(this, options)))
        if (typeof option == 'string') data[option]()
      })
    }

    var old = $.fn.scrollspy

    $.fn.scrollspy             = Plugin
    $.fn.scrollspy.Constructor = ScrollSpy


    // SCROLLSPY NO CONFLICT
    // =====================

    $.fn.scrollspy.noConflict = function () {
      $.fn.scrollspy = old
      return this
    }


    // SCROLLSPY DATA-API
    // ==================

    $(window).on('load.bs.scrollspy.data-api', function () {
      $('[data-spy="scroll"]').each(function () {
        var $spy = $(this)
        Plugin.call($spy, $spy.data())
      })
    })

  }(jQuery);
</script>


<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      $tocSelector.scrollPager({
        max: getTOCMaxHeight()
      });
    }

    function getTOCMaxHeight () {
      // TODO: Make it beautiful
      var $sidebarInner = $('.sidebar-inner');
      var height = $('.sidebar').height() -
        parseInt($sidebarInner.css('padding-top'), 10) -
        parseInt($sidebarInner.css('padding-bottom'), 10) -
        $('.sidebar-nav').height() -
        parseInt($tocSelector.css('margin-top'), 10) -
        parseInt($tocSelector.css('margin-bottom'), 10);

      $tocSelector.css('height', height);

      return height;
    }

    $(document).on('sidebar.didShow', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();
      });
    }
  });
</script>


  <script type="text/javascript" id="sidebar.nav">
    $(document).ready(function () {
      var html = $('html');

      $('.sidebar-nav li').on('click', function () {
        var item = $(this);
        var activeTabClassName = 'sidebar-nav-active';
        var activePanelClassName = 'sidebar-panel-active';
        if (item.hasClass(activeTabClassName)) {
          return;
        }

        var currentTarget = $('.' + activePanelClassName);
        var target = $('.' + item.data('target'));

        currentTarget.velocity('transition.slideUpOut', 200, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', 200)
            .addClass(activePanelClassName);
        });

        item.siblings().removeClass(activeTabClassName);
        item.addClass(activeTabClassName);
      });

      $('.post-toc a').on('click', function (e) {
        e.preventDefault();
        var offset = $(escapeSelector(this.getAttribute('href'))).offset().top;
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        });
      });

      // Expand sidebar on post detail page by default, when post has a toc.
      if ($('.post-toc').html().trim().length > 0 && isDesktop()) {
        setTimeout(function () {
          $('.sidebar-toggle').trigger('click');
        }, 800);
      }
    });
  </script>




  

  
  

  


  
</body>
</html>
